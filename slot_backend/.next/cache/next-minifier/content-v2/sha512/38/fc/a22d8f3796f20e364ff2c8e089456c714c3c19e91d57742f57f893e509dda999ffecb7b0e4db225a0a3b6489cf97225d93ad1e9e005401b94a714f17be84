{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{NP9n:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/wallets\",function(){return a(\"UJBt\")}])},UJBt:function(e,t,a){\"use strict\";a.r(t),a.d(t,\"default\",(function(){return O}));var r=a(\"o0o1\"),n=a.n(r),o=a(\"HaE+\"),s=a(\"1OyB\"),l=a(\"vuIU\"),i=a(\"JX7q\"),c=a(\"Ji7U\"),u=a(\"md7G\"),d=a(\"foSv\"),g=a(\"4q6W\"),h=a(\"YFqc\"),p=a.n(h),m=a(\"q1tI\"),f=a.n(m),v=a(\"nOHt\"),w=a.n(v),b=a(\"p46w\"),S=a.n(b),y=a(\"hryD\"),_=a(\"baXo\"),k=a.n(_),C=a(\"AO0C\"),N=f.a.createElement;function A(e){var t=function(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Object(d.a)(e);if(t){var n=Object(d.a)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Object(u.a)(this,a)}}var O=function(e){Object(c.a)(a,e);var t=A(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={isLoading:!0,data:[],rawdata:[],errorMessage:\"\",role_data:[],pagetotal:0,pagenumber:0,recordtotal:0,rowperpage:10,pagearr:[],startrow:0,endrow:0,searchtxt:\"\",memberdata:[]},r.deletewallet=r.deletewallet.bind(Object(i.a)(r)),r.setErrorMsg=r.setErrorMsg.bind(Object(i.a)(r)),r.onClick=r.onClick.bind(Object(i.a)(r)),r.onConfirmClick=r.onConfirmClick.bind(Object(i.a)(r)),r.handleSelectRowPerPageChange=r.handleSelectRowPerPageChange.bind(Object(i.a)(r)),r.handleSelectPageNumberChange=r.handleSelectPageNumberChange.bind(Object(i.a)(r)),r.onSearchClick=r.onSearchClick.bind(Object(i.a)(r)),r.handleSelectAgentChange=r.handleSelectAgentChange.bind(Object(i.a)(r)),r.onSearchLevel=r.onSearchLevel.bind(Object(i.a)(r)),r.onSearchAgentCode=r.onSearchAgentCode.bind(Object(i.a)(r)),r}return Object(l.a)(a,[{key:\"handleSelectAgentChange\",value:function(e){var t=this;if(e.preventDefault(),console.log(\"e.target.value =>\"+e.target.value),this.setState({agent:e.target.value}),\"All\"!==e.target.value){var a=this.onSearchAgentCode(e.target.value);S.a.set(\"_Agent\",e.target.value),ServiceUserAgent.getUserAgentFromAgentCode(a).then((function(e){console.log(e.data);var a=e.data,r=a.data;if(2e3===a.status){console.log(\"data length : \"+r.length),t.setState({data:r}),t.setState({rawdata:r});var n=Math.floor(r.length/t.state.rowperpage);r.length%t.state.rowperpage>0&&n++;var o,s=[];for(o=0;o<n;o++)s.push(o+1);var l=0*t.state.rowperpage,i=l+t.state.rowperpage;t.setState({recordtotal:r.length,pagetotal:n,pagenumber:1,pagearr:s,startrow:l,endrow:i})}else t.setErrorMsg(e.data.msg)}))}else S.a.remove(\"_Agent\"),ServiceUserAgent.listUserAgent().then((function(e){console.log(e.data);var a=e.data,r=a.data;if(2e3===a.status){console.log(\"data length : \"+r.length),t.setState({data:r}),t.setState({rawdata:r});var n=Math.floor(r.length/t.state.rowperpage);r.length%t.state.rowperpage>0&&n++;var o,s=[];for(o=0;o<n;o++)s.push(o+1);var l=0*t.state.rowperpage,i=l+t.state.rowperpage;t.setState({recordtotal:r.length,pagetotal:n,pagenumber:1,pagearr:s,startrow:l,endrow:i})}else t.setErrorMsg(e.data.msg)}))}},{key:\"onSearchLevel\",value:function(e){return console.log(\"get myrole\"),this.state.role_data.filter((function(t){return t.user_level_id==e})).map((function(e,t){return e.user_level_name}))}},{key:\"onSearchAgentCode\",value:function(e){return console.log(\"get Agent Code\"),this.state.agentdata.filter((function(t){return t.agent_name==e})).map((function(e,t){return e.agent_code}))}},{key:\"onClick\",value:function(){this.dialog.showAlert(\"Hello Dialog!\")}},{key:\"onConfirmClick\",value:function(){var e=this;this.dialog.show({title:\"Spiderbot confirm\",body:\"Are you sure?\",actions:[k.a.CancelAction((function(){e.dialog.hide()})),k.a.OKAction((function(){}))],bsSize:\"small\",onHide:function(t){e.dialog.hide(),console.log(\"closed by clicking background.\")}})}},{key:\"fetchUsers\",value:function(){var e=this;console.log(\"fetchUsers\"),ServiceUser.listUserrole().then((function(t){console.log(t.data);var a=t.data,r=a.data;2e3===a.status?(console.log(r),e.state.data=r):setErrorMsg(t.data.msg)}))}},{key:\"clickButton\",value:function(){w.a.push(\"/user/create\")}},{key:\"deletewallet\",value:function(){var e=Object(o.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.errorMessage&&this.setErrorMsg(\"\"),e.prev=1,e.next=4,y.i.deleteWallets(t);case 4:2e3===(a=e.sent).data.status?(this.setState({data:this.state.data.filter((function(e){return e._id!==t}))}),this.setState({rawdata:this.state.rawdata.filter((function(e){return e._id!==t}))})):(this.setErrorMsg(a.data.message),this.dialog.showAlert(a.data.message)),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(\"An unexpected error happened occurred:\",e.t0),this.setErrorMsg(e.t0.message),this.dialog.showAlert(e.t0);case 13:case\"end\":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:\"onSearchClick\",value:function(){var e=this.state.searchtxt,t=this.state.rawdata.length;\"\"!=e?(this.setState({agents:this.state.rawdata.filter((function(t){return-1!==t.agent_name.indexOf(e)}))}),t=this.state.rawdata.filter((function(t){return-1!==t.agent_name.indexOf(e)})).length):this.setState({data:this.state.rawdata});var a=Math.floor(t/this.state.rowperpage);t%this.state.rowperpage>0&&a++;var r,n=[];for(r=0;r<a;r++)n.push(r+1);var o=0*this.state.rowperpage,s=o+this.state.rowperpage;this.setState({recordtotal:t,pagetotal:a,pagenumber:1,pagearr:n,startrow:o,endrow:s})}},{key:\"componentDidMount\",value:function(){var e=this;S.a.get(\"user\")||w.a.push(\"/\"),y.f.listMember().then((function(t){console.log(t.data);var a=t.data,r=a.data;if(2e3===a.status){console.log(\"data length : \"+r.length),e.setState({memberdata:r});var n=r;y.i.listWallets().then((function(t){console.log(t.data);var a=t.data,r=a.data;if(2e3===a.status){console.log(\"data length : \"+r.length);var o=[];for(u=0;u<r.length;u++){var s=n.filter((function(e){return e.mem_username==r[u].mem_username}));console.log(\"mems : \"+JSON.stringify(s));var l=s.map((function(e,t){return e.mem_balance}));console.log(\"credit : \"+l);var i=s.map((function(e,t){return e.mem_status}));console.log(\"status : \"+i),o.push({_id:r[u]._id,mem_username:r[u].mem_username,brand_code:r[u].brand_code,game_username:r[u].game_username,game_password:r[u].game_password,agent_code:r[u].agent_code,credit:l,mem_status:i})}e.setState({data:o}),e.setState({rawdata:o});var c=Math.floor(r.length/e.state.rowperpage);r.length%e.state.rowperpage>0&&c++;var u,d=[];for(u=0;u<c;u++)d.push(u+1);var g=0*e.state.rowperpage,h=g+e.state.rowperpage;e.setState({recordtotal:r.length,pagetotal:c,pagenumber:1,pagearr:d,startrow:g,endrow:h})}else e.setErrorMsg(t.data.msg)}))}else e.setErrorMsg(t.data.msg)}))}},{key:\"setErrorMsg\",value:function(e){this.setState({errorMessage:e})}},{key:\"handleSelectRowPerPageChange\",value:function(e){e.preventDefault(),console.log(\"e.target.value :\"+e.target.value),this.setState({rowperpage:e.target.value});var t=Math.floor(this.state.recordtotal/e.target.value);console.log(\"pagetotal : \"+t);var a=this.state.recordtotal%e.target.value;console.log(\"num : \"+a),a>0&&t++;var r,n=[];for(r=0;r<t;r++)n.push(r+1);console.log(\"arr : \"+n);var o=0*e.target.value,s=o+e.target.value;this.setState({pagearr:[]}),console.log(\"startrow : \"+o),console.log(\"endrow : \"+s),this.setState({data:this.state.data,pagetotal:t,pagenumber:1,pagearr:n,startrow:o,endrow:s}),this.forceUpdate()}},{key:\"handleSelectPageNumberChange\",value:function(e){e.preventDefault(),this.setState({pagenumber:e.target.value});var t=(e.target.value-1)*this.state.rowperpage,a=t+this.state.rowperpage;this.setState({startrow:t,endrow:a})}},{key:\"render\",value:function(){var e=this;return N(g.a,{contentTitle:\"Wallets\",contentTitleButton:N(p.a,{href:\"/wallets/add\"},N(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-sm\"},N(\"i\",{className:\"fa fa-money fa-fw\"}),\" Add a new wallet\")),url:this.props.url},N(\"div\",{className:\"row\"},N(\"div\",{className:\"col-12\"},N(\"div\",{className:\"card\"},N(\"div\",{className:\"card-header\"},N(C.c,null,N(\"div\",{className:\"wrapper\"},N(\"div\",{className:\"w-auto h-25 p-3  d-inline-block\"},\"Row per page\",N(\"select\",{id:\"select-1\",className:\"form-control\",value:this.state.rowperpage,onChange:this.handleSelectRowPerPageChange},N(\"option\",{value:\"10\"},\"10\"),N(\"option\",{value:\"15\"},\"15\"),N(\"option\",{value:\"20\"},\"20\"),N(\"option\",{value:\"25\"},\"25\"),N(\"option\",{value:\"30\"},\"30\"),N(\"option\",{value:\"35\"},\"35\"),N(\"option\",{value:\"40\"},\"40\"),N(\"option\",{value:\"45\"},\"45\"),N(\"option\",{value:\"50\"},\"50\"))),N(\"div\",{className:\"w-auto h-25 p-3  d-inline-block\"},\"PageNumber\",N(\"select\",{id:\"select-1\",className:\"form-control\",value:this.state.pagenumber,onChange:this.handleSelectPageNumberChange},this.state.pagearr.map((function(e,t){return N(\"option\",{value:e,key:t},e)})))),N(\"div\",{className:\"card-tools d-inline-block\"},N(\"div\",{className:\"input-group input-group-sm\",style:{width:\"100%\"}},N(\"input\",{type:\"text\",name:\"table_search\",className:\"form-control float-right\",placeholder:\"Search\",onChange:function(t){e.setState({searchtxt:t.target.value});var a=t.target.value,r=e.state.rawdata.length;\"\"!=a?(e.setState({data:e.state.rawdata.filter((function(e){return-1!==e.user_name.indexOf(a)}))}),r=e.state.rawdata.filter((function(e){return-1!==e.user_name.indexOf(a)})).length):e.setState({data:e.state.rawdata});var n=Math.floor(r/e.state.rowperpage);r%e.state.rowperpage>0&&n++;var o,s=[];for(o=0;o<n;o++)s.push(o+1);var l=0*e.state.rowperpage,i=l+e.state.rowperpage;e.setState({recordtotal:r,pagetotal:n,pagenumber:1,pagearr:s,startrow:l,endrow:i})},value:this.state.searchtxt}),N(\"div\",{className:\"input-group-append\"},N(\"button\",{className:\"btn btn-default\"},N(\"i\",{className:\"fa fa-search\",onClick:this.onSearchClick})))))))),N(\"div\",{className:\"card-body table-responsive p-0\"},N(\"table\",{className:\"table table-hover table-striped table-bordered\"},N(\"thead\",null,N(\"tr\",null,N(\"th\",null,\"mem username\"),N(\"th\",null,\"brand code\"),N(\"th\",null,\"game username\"),N(\"th\",null,\"game password\"),N(\"th\",null,\"agent code\"),N(\"th\",null,\"credit\"),N(\"th\",{style:{textAlign:\"right\"}},\"Edit / Delete\"))),N(\"tbody\",null,this.state.data.map((function(t,a){var r=\"danger\",n=\"disable\";if(1==t.mem_status&&(r=\"success\",n=\"enable\"),a>=e.state.startrow&&a<e.state.endrow)return N(\"tr\",{key:a},N(\"td\",{className:\"py-1\"},N(\"label\",{className:\"badge badge-\".concat(r)},n),t.mem_username),N(\"td\",{className:\"py-1\"},t.brand_code),N(\"td\",{className:\"py-1\"},t.game_username),N(\"td\",{className:\"py-1\"},t.game_password),N(\"td\",{className:\"py-1\"},t.agent_code),N(\"td\",{className:\"py-1\"},t.credit),N(\"td\",{className:\"py-1\",style:{textAlign:\"right\"}},N(\"button\",{type:\"button\",className:\"btn btn-warning btn-icon-text\",onClick:function(){console.log(\"edit wallet id \"+t._id),S.a.set(\"walletid\",t._id),w.a.push(\"/wallets/edit\")},style:{width:80}},\"Edit\"),N(\"button\",{type:\"button\",onClick:function(){e.dialog.show({title:\"Slot Admin confirm\",body:\"Are you sure?\",actions:[k.a.CancelAction((function(){e.dialog.hide()})),k.a.OKAction((function(){console.log(\"delete wallet id \"+t._id),e.deletewallet(t._id)}))],bsSize:\"small\",onHide:function(t){e.dialog.hide(),console.log(\"closed by clicking background.\")}})},style:{marginLeft:5,width:80},className:\"btn btn-danger btn-icon-text\"},\"Delete\")))}))))))),N(k.a,{ref:function(t){e.dialog=t}})))}}]),a}(f.a.Component)}},[[\"NP9n\",0,2,4,8,1,3,5,6,7]]]);","extractedComments":[]}