{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport AdminLayoutHoc from \"../../components/Layout/AdminLayoutHoc\";\nimport Link from 'next/link';\nimport React, { useState, useEffect, Component } from \"react\";\nimport Router from \"next/router\";\nimport Cookies from \"js-cookie\";\nimport { ServiceAgent, ServiceUserAgent, ServiceBrand, ServiceMember, ServiceGameService, ServiceWallets } from \"../../service\";\nimport Dialog from 'react-bootstrap-dialog';\n\nvar EditWallets = /*#__PURE__*/function (_React$Component) {\n  _inherits(EditWallets, _React$Component);\n\n  var _super = _createSuper(EditWallets);\n\n  function EditWallets(props) {\n    var _this;\n\n    _classCallCheck(this, EditWallets);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSwitchChange\", function (nr) {\n      return function () {\n        var switchNumber = \"switch\".concat(nr);\n\n        _this.setState(_defineProperty({}, switchNumber, !_this.state[switchNumber]));\n      };\n    });\n\n    _this.state = {\n      //auth: { username: \"\", password: \"\", role: \"3\", rolename: \"User\" },            \n      user_name: \"\",\n      user_email: \"\",\n      user_pass: \"\",\n      add_date: \"\",\n      user_level: \"3\",\n      user_status: \"\",\n      //1=enable , 0=disable\n      switch1: true,\n      walletid: Cookies.get(\"walletid\"),\n      errorMessage: \"\",\n      datas: [],\n      role_data: [],\n      mydatas: {},\n      //value: \"Master\",\n      data_service: [],\n      data_agent: [],\n      data_brand: [],\n      data_member: [],\n      brand: \"\",\n      mem: \"\",\n      agent: \"\",\n      isDownLine: false,\n      game_username: \"\",\n      game_password: \"\",\n      agent_code: \"\",\n      brand_code: \"\",\n      credit: \"0\" // role: \"3\",\n      // rolename: \"User\",\n\n    };\n    _this.handleSelectChange = _this.handleSelectChange.bind(_assertThisInitialized(_this));\n    _this.handleToggleChange = _this.handleToggleChange.bind(_assertThisInitialized(_this));\n    _this.handleSubmit = _this.handleSubmit.bind(_assertThisInitialized(_this));\n    _this.setErrorMsg = _this.setErrorMsg.bind(_assertThisInitialized(_this)); //this.onClick = this.onClick.bind(this);\n    //this.onConfirmClick = this.onConfirmClick.bind(this)\n\n    _this.handleResetSubmit = _this.handleResetSubmit.bind(_assertThisInitialized(_this)); //this.onSearchLevel = this.onSearchLevel.bind(this);\n\n    _this.onSearchAgentCode = _this.onSearchAgentCode.bind(_assertThisInitialized(_this));\n    _this.handleSelectMemberChange = _this.handleSelectMemberChange.bind(_assertThisInitialized(_this)); //this.SearchAgent = this.SearchAgent.bind(this);\n\n    _this.handleSelectBrandChange = _this.handleSelectBrandChange.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(EditWallets, [{\n    key: \"handleSelectBrandChange\",\n    value: function handleSelectBrandChange(e) {\n      e.preventDefault();\n      console.log('e.target.value =>' + e.target.value);\n      this.setState({\n        brand: e.target.value\n      });\n    }\n  }, {\n    key: \"handleSelectMemberChange\",\n    value: function handleSelectMemberChange(e) {\n      var _this2 = this;\n\n      e.preventDefault();\n      console.log('e.target.value =>' + e.target.value);\n      var agent_code = this.onSearchAgentCode(e.target.value)[0];\n      this.setState({\n        mem: e.target.value,\n        agent_code: agent_code\n      });\n      ServiceBrand.listBrands().then(function (res) {\n        console.log(res.data);\n        var _res$data = res.data,\n            data = _res$data.data,\n            status = _res$data.status;\n\n        if (status === 2000) {\n          console.log(\"data length : \" + data.length); //this.setState({ data_brand: data });\n\n          var data_brand = data;\n\n          var agent_lineup = _this2.SearchAgent_LineUp(agent_code)[0];\n\n          console.log('agent_lineup =>' + agent_lineup);\n          console.log('agent_code =>' + agent_code);\n          Cookies.set(\"serviceagent\", agent_code);\n          var agent_param = \"\";\n\n          if (agent_lineup === \"\" || agent_lineup === \"-\") {\n            _this2.setState({\n              isDownLine: false\n            });\n\n            agent_param = agent_code;\n          } else {\n            _this2.setState({\n              isDownLine: true\n            });\n\n            agent_param = agent_lineup;\n          }\n\n          ServiceGameService.listServiceFromAgent(agent_param).then(function (res) {\n            console.log(res.data);\n            var _res$data2 = res.data,\n                data = _res$data2.data,\n                status = _res$data2.status;\n\n            if (status === 2000) {\n              console.log(\"data service length : \" + data.length);\n\n              _this2.setState({\n                data_service: data\n              });\n\n              var my_data_brand = [];\n              var i;\n\n              for (i = 0; i < data.length; i++) {\n                //data_brand.filter()\n                var brands = data_brand.filter(function (brand) {\n                  return brand.brand_code == data[i].brand_code;\n                }); //console.log('brands : ' + brands);\n\n                var brand_name = brands.map(function (brand, index) {\n                  return brand.brand_name;\n                });\n                console.log('brand_name : ' + brand_name[0]);\n                my_data_brand.push({\n                  brand_name: brand_name[0],\n                  brand_code: data[i].brand_code\n                });\n              }\n\n              console.log('data_brand : ' + JSON.stringify(my_data_brand));\n\n              _this2.setState({\n                data_brand: my_data_brand\n              });\n\n              _this2.setState({\n                brand: my_data_brand[0].brand_name\n              });\n\n              _this2.setState({\n                brand_code: my_data_brand[0].brand_code\n              });\n            } else {\n              _this2.setErrorMsg(res.data.msg);\n            }\n          });\n        } else {\n          _this2.setErrorMsg(res.data.msg);\n        }\n      });\n    }\n  }, {\n    key: \"onSearchAgentCode\",\n    value: function onSearchAgentCode(mem_username) {\n      console.log('get Agent Code');\n      var mems = this.state.data_member.filter(function (mem) {\n        return mem.mem_username == mem_username;\n      });\n      var agentCode = mems.map(function (mem, index) {\n        return mem.agent_code;\n      }); //console.log('myrole:' + myrole);\n\n      return agentCode;\n    }\n  }, {\n    key: \"handleResetSubmit\",\n    value: function handleResetSubmit() {\n      Router.push(\"/wallets\");\n    }\n  }, {\n    key: \"SearchAgent_LineUp\",\n    value: function SearchAgent_LineUp(agent_code) {\n      console.log('get agent_code');\n      var agents = this.state.data_agent.filter(function (agent) {\n        return agent.agent_code == agent_code;\n      });\n      var agent_lineup = agents.map(function (agent, index) {\n        return agent.agent_lineup;\n      }); //console.log('myrole:' + myrole);\n\n      return agent_lineup;\n    }\n  }, {\n    key: \"SearchAgent_LineUp2\",\n    value: function SearchAgent_LineUp2(data_agent, agent_code) {\n      console.log('get agent_code');\n      var agents = data_agent.filter(function (agent) {\n        return agent.agent_code == agent_code;\n      });\n      console.log('agents : ' + JSON.stringify(agents));\n      var agent_lineup = agents.map(function (agent, index) {\n        return agent.agent_lineup;\n      }); //console.log('myrole:' + myrole);\n\n      return agent_lineup;\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function () {\n      var _handleSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var a, res, b, res_member;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n\n                if (!(this.state.agent_code !== \"\" && this.state.brand_code !== \"\" && this.state.game_username !== \"\" && this.state.game_password !== \"\" && this.state.credit !== \"\")) {\n                  _context.next = 20;\n                  break;\n                }\n\n                a = {\n                  agent_code: this.state.agent_code,\n                  mem_username: this.state.mem,\n                  brand_code: this.state.brand_code,\n                  game_username: this.state.game_username,\n                  game_password: this.state.game_password\n                };\n                _context.next = 5;\n                return ServiceWallets.editWallets(a, this.state.walletid);\n\n              case 5:\n                res = _context.sent;\n                console.log('res : ' + res.data);\n\n                if (!(res.data.status === 2000)) {\n                  _context.next = 16;\n                  break;\n                }\n\n                b = {\n                  mem_balance: this.state.credit\n                };\n                _context.next = 11;\n                return ServiceMember.editMember(b, this.state.mem);\n\n              case 11:\n                res_member = _context.sent;\n                console.log('res : ' + res_member.data);\n\n                if (res_member.data.status === 2000) {\n                  console.log('Edit Member : ' + this.state.mem + ' wallets Successfully!!!');\n                  this.dialog.show({\n                    title: 'Slot Admin information',\n                    body: 'Edit Member : ' + this.state.mem + ' wallets to system is successfully.',\n                    actions: [Dialog.OKAction(function () {\n                      Router.push(\"/wallets\");\n                    })]\n                  });\n                } else {\n                  this.dialog.showAlert(res_member.data.message);\n                  this.setErrorMsg(res_member.data.msg);\n                }\n\n                _context.next = 18;\n                break;\n\n              case 16:\n                this.dialog.showAlert(res.data.message);\n                this.setErrorMsg(res.data.msg);\n\n              case 18:\n                _context.next = 21;\n                break;\n\n              case 20:\n                this.dialog.showAlert('กรุณาใส่ข้อมูลให้ครบ ก่อนกดปุ่ม Save!');\n\n              case 21:\n                _context.next = 28;\n                break;\n\n              case 23:\n                _context.prev = 23;\n                _context.t0 = _context[\"catch\"](0);\n                this.dialog.showAlert(_context.t0);\n                console.error(\"An unexpected error happened occurred:\", _context.t0);\n                this.setErrorMsg(_context.t0.message);\n\n              case 28:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 23]]);\n      }));\n\n      function handleSubmit() {\n        return _handleSubmit.apply(this, arguments);\n      }\n\n      return handleSubmit;\n    }()\n  }, {\n    key: \"handleSelectChange\",\n    value: function handleSelectChange(e) {\n      console.log(\"e.target.value :\" + e.target.value);\n      this.setState({\n        rolename: e.target.value\n      });\n      var v = this.onSearchLevel(e.target.value);\n      this.setState({\n        role: v,\n        user_level: v\n      });\n    }\n  }, {\n    key: \"handleToggleChange\",\n    value: function handleToggleChange(e) {\n      console.log(\"e.target.value :\" + e.target.value);\n      this.setState({\n        user_enable: e.target.value\n      });\n    }\n  }, {\n    key: \"setErrorMsg\",\n    value: function setErrorMsg(msg) {\n      console.log(msg);\n      this.setState({\n        errorMessage: msg\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      if (!Cookies.get(\"user\")) {\n        Router.push(\"/\");\n      }\n\n      ServiceWallets.getWalletsFromId(Cookies.get(\"walletid\")).then(function (res) {\n        console.log(res.data);\n        var _res$data3 = res.data,\n            data = _res$data3.data,\n            status = _res$data3.status;\n\n        if (status === 2000) {\n          console.log(\"data length : \" + data.length);\n          var _data$ = data[0],\n              mem_username = _data$.mem_username,\n              brand_code = _data$.brand_code,\n              game_username = _data$.game_username,\n              game_password = _data$.game_password,\n              agent_code = _data$.agent_code;\n\n          _this3.setState({\n            mem: mem_username,\n            brand_code: brand_code,\n            game_username: game_username,\n            game_password: game_password,\n            agent_code: agent_code\n          });\n\n          ServiceMember.getBalance(mem_username).then(function (res) {\n            console.log(\"res : \" + JSON.stringify(res.data));\n            var _res$data4 = res.data,\n                data = _res$data4.data,\n                status = _res$data4.status;\n\n            if (status === 2000) {\n              var mem_balance = data.mem_balance;\n\n              _this3.setState({\n                credit: mem_balance\n              });\n            } else {\n              _this3.setErrorMsg(res.data.msg);\n            }\n          })[\"catch\"](function (error) {\n            _this3.setErrorMsg(error);\n          });\n        } else {\n          _this3.setErrorMsg(res.data.msg);\n        }\n      })[\"catch\"](function (error) {\n        _this3.setErrorMsg(error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var element = __jsx(\"div\", {\n        className: \"toggle-switch\"\n      }, __jsx(\"input\", {\n        type: \"checkbox\",\n        \"data-toggle\": \"toggle\",\n        \"data-on\": \"Ready\",\n        \"data-off\": \"Not Ready\",\n        \"data-onstyle\": \"success\",\n        \"data-offstyle\": \"danger\"\n      }));\n\n      return __jsx(AdminLayoutHoc, {\n        contentTitle: 'Edit Wallets',\n        contentTitleButton: __jsx(\"i\", {\n          className: \"fa fa-2x fa-money\"\n        }),\n        url: this.props.url\n      }, __jsx(\"div\", {\n        className: \"offset-md-0\"\n      }, __jsx(\"div\", {\n        className: \"card\"\n      }, __jsx(\"div\", {\n        className: \"card-header\"\n      }), __jsx(\"form\", {\n        className: \"form-horizontal\"\n      }, __jsx(\"div\", {\n        className: \"card-body\"\n      }, __jsx(\"div\", {\n        className: \"form-group\"\n      }, __jsx(\"div\", {\n        className: \"col-sm-10\"\n      }, __jsx(\"div\", {\n        className: \"input-group mb-3 input-group-sm\"\n      }, __jsx(\"div\", {\n        className: \"input-group-prepend\"\n      }, __jsx(\"span\", {\n        className: \"input-group-text\"\n      }, \"Member\")), __jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control \",\n        id: \"validation-ex2\" //placeholder=\"agent lineup\"\n        ,\n        onChange: function onChange(e) {\n          return _this4.setState({\n            mem: e.target.value\n          });\n        },\n        value: this.state.mem,\n        required: true,\n        disabled: true\n      })))), __jsx(\"div\", {\n        className: \"form-group\"\n      }, __jsx(\"div\", {\n        className: \"col-sm-10\"\n      }, __jsx(\"div\", {\n        className: \"input-group mb-3 input-group-sm\"\n      }, __jsx(\"div\", {\n        className: \"input-group-prepend\"\n      }, __jsx(\"span\", {\n        className: \"input-group-text\"\n      }, \"agent code\")), __jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control \",\n        id: \"validation-ex2\" //placeholder=\"agent lineup\"\n        ,\n        onChange: function onChange(e) {\n          return _this4.setState({\n            agent_code: e.target.value\n          });\n        },\n        value: this.state.agent_code,\n        required: true,\n        disabled: true\n      })))), __jsx(\"div\", {\n        className: \"form-group\"\n      }, __jsx(\"div\", {\n        className: \"col-sm-10\"\n      }, __jsx(\"div\", {\n        className: \"input-group mb-3 input-group-sm\"\n      }, __jsx(\"div\", {\n        className: \"input-group-prepend\"\n      }, __jsx(\"span\", {\n        className: \"input-group-text\"\n      }, \"brand code\")), __jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control \",\n        id: \"validation-ex2\" //placeholder=\"agent lineup\"\n        ,\n        onChange: function onChange(e) {\n          return _this4.setState({\n            brand_code: e.target.value\n          });\n        },\n        value: this.state.brand_code,\n        required: true,\n        disabled: true\n      })))), __jsx(\"div\", {\n        className: \"form-group\"\n      }, __jsx(\"div\", {\n        className: \"col-sm-10\"\n      }, __jsx(\"div\", {\n        className: \"input-group mb-3 input-group-sm\"\n      }, __jsx(\"div\", {\n        className: \"input-group-prepend\"\n      }, __jsx(\"span\", {\n        className: \"input-group-text\"\n      }, \"game username\")), __jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control \",\n        id: \"validation-ex3\" //placeholder=\"agent name\"\n        ,\n        onChange: function onChange(e) {\n          return _this4.setState({\n            game_username: e.target.value\n          });\n        },\n        value: this.state.game_username,\n        required: true\n      })))), __jsx(\"div\", {\n        className: \"form-group\"\n      }, __jsx(\"div\", {\n        className: \"col-sm-10\"\n      }, __jsx(\"div\", {\n        className: \"input-group mb-3 input-group-sm\"\n      }, __jsx(\"div\", {\n        className: \"input-group-prepend\"\n      }, __jsx(\"span\", {\n        className: \"input-group-text\"\n      }, \"game password\")), __jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control \",\n        id: \"validation-ex4\" //placeholder=\"agent detail\"\n        ,\n        onChange: function onChange(e) {\n          return _this4.setState({\n            game_password: e.target.value\n          });\n        },\n        value: this.state.game_password,\n        required: true\n      })))), __jsx(\"div\", {\n        className: \"form-group\"\n      }, __jsx(\"div\", {\n        className: \"col-sm-10\"\n      }, __jsx(\"div\", {\n        className: \"input-group mb-3 input-group-sm\"\n      }, __jsx(\"div\", {\n        className: \"input-group-prepend\"\n      }, __jsx(\"span\", {\n        className: \"input-group-text\"\n      }, \"credit\")), __jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control \",\n        id: \"validation-ex3\" //placeholder=\"Password\"\n        ,\n        onChange: function onChange(e) {\n          return _this4.setState({\n            credit: e.target.value\n          });\n        },\n        value: this.state.credit,\n        required: true\n      })))))), __jsx(\"div\", {\n        className: \"card-footer\"\n      }, __jsx(\"div\", {\n        className: \"d-inline-block btn-block\"\n      }, __jsx(\"button\", {\n        className: \"btn btn-danger\",\n        onClick: this.handleResetSubmit\n      }, \"Back\"), __jsx(\"button\", {\n        className: \"btn btn-info float-right\",\n        onClick: this.handleSubmit\n      }, \"Save\")))), __jsx(Dialog, {\n        ref: function ref(el) {\n          _this4.dialog = el;\n        }\n      })));\n    }\n  }]);\n\n  return EditWallets;\n}(React.Component);\n\nexport { EditWallets as default };","map":null,"metadata":{},"sourceType":"module"}