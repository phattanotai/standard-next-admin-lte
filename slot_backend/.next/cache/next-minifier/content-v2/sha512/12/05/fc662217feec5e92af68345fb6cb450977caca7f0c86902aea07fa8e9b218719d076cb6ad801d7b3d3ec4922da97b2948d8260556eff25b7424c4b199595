{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{\"Q+mf\":function(t,e,a){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/agents\",function(){return a(\"f02n\")}])},f02n:function(t,e,a){\"use strict\";a.r(e),a.d(e,\"default\",(function(){return A}));var n=a(\"o0o1\"),r=a.n(n),o=a(\"HaE+\"),s=a(\"1OyB\"),l=a(\"vuIU\"),i=a(\"JX7q\"),c=a(\"Ji7U\"),u=a(\"md7G\"),d=a(\"foSv\"),g=a(\"4q6W\"),h=a(\"YFqc\"),p=a.n(h),f=a(\"q1tI\"),v=a.n(f),b=a(\"nOHt\"),m=a.n(b),w=a(\"p46w\"),y=a.n(w),k=a(\"hryD\"),S=a(\"baXo\"),N=a.n(S),C=a(\"AO0C\"),_=v.a.createElement;function O(t){var e=function(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=Object(d.a)(t);if(e){var r=Object(d.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(u.a)(this,a)}}var A=function(t){Object(c.a)(a,t);var e=O(a);function a(t){var n;return Object(s.a)(this,a),(n=e.call(this,t)).state={isLoading:!0,data:[],rawdata:[],errorMessage:\"\",role_data:[],pagetotal:0,pagenumber:0,recordtotal:0,rowperpage:10,pagearr:[],startrow:0,endrow:0,searchtxt:\"\"},n.deleteAgent=n.deleteAgent.bind(Object(i.a)(n)),n.setErrorMsg=n.setErrorMsg.bind(Object(i.a)(n)),n.onClick=n.onClick.bind(Object(i.a)(n)),n.onConfirmClick=n.onConfirmClick.bind(Object(i.a)(n)),n.handleSelectRowPerPageChange=n.handleSelectRowPerPageChange.bind(Object(i.a)(n)),n.handleSelectPageNumberChange=n.handleSelectPageNumberChange.bind(Object(i.a)(n)),n.onSearchClick=n.onSearchClick.bind(Object(i.a)(n)),n}return Object(l.a)(a,[{key:\"onClick\",value:function(){this.dialog.showAlert(\"Hello Dialog!\")}},{key:\"onConfirmClick\",value:function(){var t=this;this.dialog.show({title:\"Spiderbot confirm\",body:\"Are you sure?\",actions:[N.a.CancelAction((function(){t.dialog.hide()})),N.a.OKAction((function(){}))],bsSize:\"small\",onHide:function(e){t.dialog.hide(),console.log(\"closed by clicking background.\")}})}},{key:\"fetchUsers\",value:function(){var t=this;console.log(\"fetchUsers\"),ServiceUser.listUserrole().then((function(e){console.log(e.data);var a=e.data,n=a.data;2e3===a.status?(console.log(n),t.state.data=n):setErrorMsg(e.data.msg)}))}},{key:\"clickButton\",value:function(){m.a.push(\"/user/create\")}},{key:\"deleteAgent\",value:function(){var t=Object(o.a)(r.a.mark((function t(e){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.state.errorMessage&&this.setErrorMsg(\"\"),t.prev=1,t.next=4,k.a.deleteAgent(e);case 4:2e3===(a=t.sent).data.status?(this.setState({data:this.state.data.filter((function(t){return t._id!==e}))}),this.setState({rawdata:this.state.rawdata.filter((function(t){return t._id!==e}))})):(this.setErrorMsg(a.data.message),this.dialog.showAlert(a.data.message)),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(\"An unexpected error happened occurred:\",t.t0),this.setErrorMsg(t.t0.message),this.dialog.showAlert(t.t0);case 13:case\"end\":return t.stop()}}),t,this,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},{key:\"onSearchClick\",value:function(){var t=this.state.searchtxt,e=this.state.rawdata.length;\"\"!=t?(this.setState({agents:this.state.rawdata.filter((function(e){return-1!==e.agent_name.indexOf(t)}))}),e=this.state.rawdata.filter((function(e){return-1!==e.agent_name.indexOf(t)})).length):this.setState({data:this.state.rawdata});var a=Math.floor(e/this.state.rowperpage);e%this.state.rowperpage>0&&a++;var n,r=[];for(n=0;n<a;n++)r.push(n+1);var o=0*this.state.rowperpage,s=o+this.state.rowperpage;this.setState({recordtotal:e,pagetotal:a,pagenumber:1,pagearr:r,startrow:o,endrow:s})}},{key:\"componentDidMount\",value:function(){var t=this;y.a.get(\"user\")||m.a.push(\"/\"),k.a.listAgent().then((function(e){console.log(e.data);var a=e.data,n=a.data;if(2e3===a.status){console.log(\"data length : \"+n.length),t.setState({data:n}),t.setState({rawdata:n});var r=Math.floor(n.length/t.state.rowperpage);n.length%t.state.rowperpage>0&&r++;var o,s=[];for(o=0;o<r;o++)s.push(o+1);var l=0*t.state.rowperpage,i=l+t.state.rowperpage;t.setState({recordtotal:n.length,pagetotal:r,pagenumber:1,pagearr:s,startrow:l,endrow:i})}else t.setErrorMsg(e.data.msg)}))}},{key:\"setErrorMsg\",value:function(t){this.setState({errorMessage:t})}},{key:\"handleSelectRowPerPageChange\",value:function(t){t.preventDefault(),console.log(\"e.target.value :\"+t.target.value),this.setState({rowperpage:t.target.value});var e=Math.floor(this.state.recordtotal/t.target.value);console.log(\"pagetotal : \"+e);var a=this.state.recordtotal%t.target.value;console.log(\"num : \"+a),a>0&&e++;var n,r=[];for(n=0;n<e;n++)r.push(n+1);console.log(\"arr : \"+r);var o=0*t.target.value,s=o+t.target.value;this.setState({pagearr:[]}),console.log(\"startrow : \"+o),console.log(\"endrow : \"+s),this.setState({data:this.state.data,pagetotal:e,pagenumber:1,pagearr:r,startrow:o,endrow:s}),this.forceUpdate()}},{key:\"handleSelectPageNumberChange\",value:function(t){t.preventDefault(),this.setState({pagenumber:t.target.value});var e=(t.target.value-1)*this.state.rowperpage,a=e+this.state.rowperpage;this.setState({startrow:e,endrow:a})}},{key:\"render\",value:function(){var t=this;return _(g.a,{contentTitle:\"Agents\",contentTitleButton:_(p.a,{href:\"/agents/add\"},_(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-sm\"},_(\"i\",{className:\"fa fa-id-badge fa-fw\"}),\" Add a new agent\")),url:this.props.url},_(\"div\",{className:\"row\"},_(\"div\",{className:\"col-12\"},_(\"div\",{className:\"card\"},_(\"div\",{className:\"card-header\"},_(C.c,null,_(\"div\",{className:\"wrapper\"},_(\"div\",{className:\"w-auto h-25 p-3  d-inline-block\"},\"Row per page\",_(\"select\",{id:\"select-1\",className:\"form-control\",value:this.state.rowperpage,onChange:this.handleSelectRowPerPageChange},_(\"option\",{value:\"10\"},\"10\"),_(\"option\",{value:\"15\"},\"15\"),_(\"option\",{value:\"20\"},\"20\"),_(\"option\",{value:\"25\"},\"25\"),_(\"option\",{value:\"30\"},\"30\"),_(\"option\",{value:\"35\"},\"35\"),_(\"option\",{value:\"40\"},\"40\"),_(\"option\",{value:\"45\"},\"45\"),_(\"option\",{value:\"50\"},\"50\"))),_(\"div\",{className:\"w-auto h-25 p-3  d-inline-block\"},\"PageNumber\",_(\"select\",{id:\"select-1\",className:\"form-control\",value:this.state.pagenumber,onChange:this.handleSelectPageNumberChange},this.state.pagearr.map((function(t,e){return _(\"option\",{value:t,key:e},t)})))),_(\"div\",{className:\"card-tools d-inline-block\"},_(\"div\",{className:\"input-group input-group-sm\",style:{width:\"100%\"}},_(\"input\",{type:\"text\",name:\"table_search\",className:\"form-control float-right\",placeholder:\"Search\",onChange:function(e){t.setState({searchtxt:e.target.value});var a=e.target.value,n=t.state.rawdata.length;\"\"!=a?(t.setState({data:t.state.rawdata.filter((function(t){return-1!==t.agent_name.indexOf(a)}))}),n=t.state.rawdata.filter((function(t){return-1!==t.agent_name.indexOf(a)})).length):t.setState({data:t.state.rawdata});var r=Math.floor(n/t.state.rowperpage);n%t.state.rowperpage>0&&r++;var o,s=[];for(o=0;o<r;o++)s.push(o+1);var l=0*t.state.rowperpage,i=l+t.state.rowperpage;t.setState({recordtotal:n,pagetotal:r,pagenumber:1,pagearr:s,startrow:l,endrow:i})},value:this.state.searchtxt}),_(\"div\",{className:\"input-group-append\"},_(\"button\",{className:\"btn btn-default\"},_(\"i\",{className:\"fa fa-search\",onClick:this.onSearchClick})))))))),_(\"div\",{className:\"card-body table-responsive p-0\"},_(\"table\",{className:\"table table-hover\"},_(\"thead\",null,_(\"tr\",null,_(\"th\",null,\"Code\"),_(\"th\",null,\"Name\"),_(\"th\",null,\"LineUp\"),_(\"th\",null,\"Line@\"),_(\"th\",null,\"WebSite\"),_(\"th\",null,\"Type\"),_(\"th\",{style:{textAlign:\"right\"}},\"Detail / Edit / Delete\"))),_(\"tbody\",null,this.state.data.map((function(e,a){var n=\"danger\",r=\"disable\";if(\"1\"===e.agent_status&&(n=\"success\",r=\"enable\"),a>=t.state.startrow&&a<t.state.endrow)return _(\"tr\",{key:a},_(\"td\",{className:\"py-1\"},_(\"label\",{className:\"badge badge-\".concat(n)},r),e.agent_code),_(\"td\",{className:\"py-1\"},e.agent_name),_(\"td\",{className:\"py-1\"},e.agent_lineup),_(\"td\",{className:\"py-1\"},e.agent_line_ad),_(\"td\",{className:\"py-1\"},e.agent_website),_(\"td\",{className:\"py-1\"},e.agent_type),_(\"td\",{className:\"py-1\",style:{textAlign:\"right\"}},_(\"button\",{type:\"button\",className:\"btn btn-success btn-icon-text\",onClick:function(){console.log(\"Description agid\"+e._id),y.a.set(\"agentid\",e._id),m.a.push(\"/agents/description\")}},\"Detail\"),\"\\xa0\",_(\"button\",{type:\"button\",className:\"btn btn-warning btn-icon-text\",onClick:function(){console.log(\"edit agent id\"+e._id),y.a.set(\"agentid\",e._id),m.a.push(\"/agents/edit\")}},\"Edit\"),_(\"button\",{type:\"button\",onClick:function(){t.dialog.show({title:\"Slot Admin confirm\",body:\"Are you sure?\",actions:[N.a.CancelAction((function(){t.dialog.hide()})),N.a.OKAction((function(){console.log(\"delete userid\"+e._id),t.deleteAgent(e._id)}))],bsSize:\"small\",onHide:function(e){t.dialog.hide(),console.log(\"closed by clicking background.\")}})},style:{marginLeft:5},className:\"btn btn-danger btn-icon-text\"},\"Delete\")))}))))))),_(N.a,{ref:function(e){t.dialog=e}})))}}]),a}(v.a.Component)}},[[\"Q+mf\",0,2,4,8,1,3,5,6,7]]]);","extractedComments":[]}